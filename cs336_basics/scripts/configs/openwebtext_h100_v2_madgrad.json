{
  "train_data_path": "data/encoded/owt_train_tokens.npy",
  "val_data_path": "data/encoded/owt_valid_tokens.npy",
  "vocab_size": 32000,
  "context_length": 512,
  "d_model": 1024,
  "num_layers": 16,
  "num_heads": 8,
  "d_ff": 4096,
  "rope_theta": 10000.0,
  "eps": 1e-05,
  "tie_embeddings": false,
  "activation": "custom",
  "use_unet_architecture": true,
  "max_steps": 20000,
  "max_wallclock_hours": 1.5,
  "batch_size": 128,
  "gradient_accumulation_steps": 2,
  "optimizer": "mixed_v3",
  "optimizer_type": "madgrad",
  "lr_schedule": "linear_decay_to_zero",
  "learning_rate": 0.004,
  "muon_lr": 0.004,
  "adam_lr": 0.003,
  "madgrad_lr": 0.01,
  "embedding_lr": 0.012,
  "lm_head_lr": 0.008,
  "min_learning_rate": 0.0,
  "warmup_steps": 300,
  "weight_decay": 0.01,
  "momentum": 0.95,
  "madgrad_momentum": 0.9,
  "ns_iters": 5,
  "beta1": 0.9,
  "beta2": 0.85,
  "use_hybrid_clipping": true,
  "use_adaptive_clipping": true,
  "grad_clip_norm": 1.0,
  "zclip_z_threshold": 2.5,
  "zclip_window_size": 200,
  "zclip_min_threshold": 0.1,
  "zclip_max_threshold": 3.0,
  "adagc_beta": 0.98,
  "use_amp": true,
  "use_bfloat16": true,
  "use_gradient_checkpointing": true,
  "gradient_checkpointing_layers": 8,
  "use_tf32": true,
  "compile_model": true,
  "torch_compile_backend": "inductor",
  "torch_empty_cache_steps": 25,
  "channels_last": true,
  "num_workers": 12,
  "pin_memory": true,
  "prefetch_factor": 6,
  "dataloader_drop_last": true,
  "use_label_smoothing": false,
  "label_smoothing": 0.0,
  "detect_anomalies": false,
  "emergency_lr_reduction": 0.3,
  "max_consecutive_failures": 3,
  "outlier_threshold": 5.0,
  "enable_outlier_detection": true,
  "stability_check_freq": 20,
  "max_norm_scale": 5.0,
  "enable_stability_logging": true,
  "stability_warmup_steps": 500,
  "use_robust_initialization": true,
  "use_outlier_safe_training": true,
  "log_interval": 20,
  "eval_interval": 200,
  "eval_batches": 50,
  "save_interval": 1000,
  "checkpoint_dir": "checkpoints",
  "experiment_name": "openwebtext_madgrad_champion_v4",
  "experiment_description": "Using Madgrad optimizer - FB AI's transformer champion for beating 3.0781",
  "use_wandb": true,
  "wandb_project": "cs336-assignment1",
  "device": "cuda",
  "resume_from": null,
  "auto_resume": true,
  "use_flash_attention": true,
  "attention_implementation": "sdpa",
  "fused_adamw": true,
  "use_fused_ops": true,
  "dataloader_persistent_workers": true,
  "compile_mode": "max-autotune",
  "use_dynamo_cache": true,
  "use_stability_monitoring": true,
  "stability_window_size": 100,
  "anomaly_detection_threshold": 3.0,
  "use_parameter_health_checks": true,
  "health_check_interval": 50,
  "use_gradient_health_checks": true,
  "gradient_health_threshold": 10.0,
  "use_loss_spike_detection": true,
  "loss_spike_threshold": 2.0,
  "loss_spike_window": 50,
  "use_automatic_recovery": true,
  "recovery_lr_factor": 0.5,
  "recovery_steps": 100,
  "use_mixed_precision_safety": true,
  "fp32_modules": ["lm_head", "embedding"],
  "use_conservative_compilation": true,
  "compile_warmup_steps": 200,
  "use_memory_efficient_attention": true,
  "attention_dropout": 0.0,
  "use_layer_wise_lr_decay": true,
  "layer_wise_decay_factor": 0.95,
  "use_advanced_adam_clipping": true,
  "adam_clip_threshold": 1.0,
  "use_cosine_restarts": false,
  "restart_cycles": 2
} 